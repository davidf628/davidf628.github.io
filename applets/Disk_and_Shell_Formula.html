<html>
<head>
	<meta charset="utf-8">  
		<link rel='stylesheet' type='text/css' href='https://jsxgraph.uni-bayreuth.de/distrib/jsxgraph.css' />
		<script src='https://jsxgraph.uni-bayreuth.de/distrib/jsxgraphcore.js' type='text/javascript'></script>
		<script src='https://jsxgraph.uni-bayreuth.de/distrib/GeonextReader.js' type='text/javascript'></script>
	</meta>
</head>

<body>

<h1>Disk and Shell Method Formulas</h1>
Y Minimum = <input type="text" id="lower_bound" value="">
Y Maximum = <input type="text" id="upper_bound" value="">
</br>
X Minimum = <input type="text" id="left_bound" value="">
X Maximum = <input type="text" id="right_bound" value="">
</br>
Slider Min = <input type="text" id="slider_min" value="0">
Slider Max = <input type="text" id="slider_max" value="10">
</br>
<input type="button" value="Update" onClick="update()">

<div id="jxgbox" class="jxgbox" style="width:1000px; height:720px; float:left"></div>

<script type='text/javascript'>

var board = JXG.JSXGraph.initBoard('jxgbox', {
		boundingbox: [-10,10,10,-10], 
      	showCopyright: false, 
      	showNavigation: true,
		keepaspectratio: true,
		axis: true,
      	zoom: {
            factorX: 1.25,
            factorY: 1.25,
            wheel: true,
            needshift: false,
            eps: 0.1
        }		
    });
			
// Initialize curves so that we have something we can update
var curves = [];
curves[0] = board.create('curve', [0, 0], 0, 0, { visible: false });
curves[1] = board.create('curve', [0, 0], 0, 0, { visible: false });
curves[2] = board.create('curve', [0, 0], 0, 0, { visible: false });
curves[3] = board.create('curve', [0, 0], 0, 0, { visible: false });

slider_p1 = [15, 8];
slider_p2 = [15, 2];
slider_min = parseInt(document.getElementById('slider_min').value);
slider_max = parseInt(document.getElementById('slider_max').value);
slider_avg = (slider_min + slider_max) / 2;

slider = board.create('slider', [slider_p1, slider_p2, [slider_max, slider_avg, slider_min]], { withLabel: true });

board.create('text', [10, -7, 'Rectangle Orientation:']);
vertical_rectangle = board.create('checkbox', [10.5, -7.5, 'Vertical']);
horizontal_rectangle = board.create('checkbox', [10.5, -8, 'Horizontal']);

board.create('text', [14, -7, 'Axis of Rotation:']);
cb_vertical_axis = board.create('checkbox', [14.5, -7.5, 'Vertical']);
cb_horizontal_axis = board.create('checkbox', [14.5, -8, 'Horizontal']);

hidden_horiz_line = board.create('line', [[-10, -9], [20, -9]], { visible: false });
vert_axis_loc = board.create('glider', [0, 0, hidden_horiz_line], { name: 'v', withLabel: false, showInfoBox: false, visible: false });
vertical_axis = board.create('line', [vert_axis_loc, [function() { return vert_axis_loc.X() }, 0]], { dash: 3, color: 'black', visible: false });

hidden_vert_line = board.create('line', [[-9, 9], [-9, -9]], { visible: false });
horiz_axis_loc = board.create('glider', [0, 0, hidden_vert_line], { name: 'h', withlabel: false, showInfoBox: false });
horizontal_axis = board.create('line', [horiz_axis_loc, [0, function() { return horiz_axis_loc.Y() }]], { dash: 3, color: 'black'});

method_label = board.create('text', [-9, -5, 'Disk Method']);
disk_method = true;

// Default state of check boxes
vertical_rectangle.rendNodeCheckbox.checked = true;
horizontal_rectangle.rendNodeCheckbox.checked = false;

cb_vertical_axis.rendNodeCheckbox.checked = false;
cb_horizontal_axis.rendNodeCheckbox.checked = true;


	function set_method() {
		//alert('vertical rectangle == ' + vertical_rectangle.Value() + '  horizontal rectangle == ' + horizontal_rectangle.Value() + '\n' + 'vertical axis == ' + cb_vertical_axis.Value() + '  horizontal axis == ' + cb_horizontal_axis.Value());
		if((vertical_rectangle.Value() && cb_horizontal_axis.Value()) || (horizontal_rectangle.Value() && cb_vertical_axis.Value())) {
			disk_method = true;
			method_label.setText('Disk Method');
			//alert('We\'ll call it the Disk Method');
		}
		if((vertical_rectangle.Value() && cb_vertical_axis.Value()) || (horizontal_rectangle.Value() && cb_horizontal_axis.Value())) {
			disk_method = false;
			method_label.setText('Shell Method');
			//alert('We\'ll call it the Shell Method');
		} 
	};
	

JXG.addEvent(vertical_rectangle.rendNodeCheckbox, 'change', 
	function() {
		horizontal_rectangle.rendNodeCheckbox.checked = false;	
		vertical_rectangle.rendNodeCheckbox.checked = true;
		set_method()
		board.update();
    }, vertical_rectangle);
		
JXG.addEvent(horizontal_rectangle.rendNodeCheckbox, 'change', 
	function() {
		horizontal_rectangle.rendNodeCheckbox.checked = true;	
		vertical_rectangle.rendNodeCheckbox.checked = false;
		set_method();
		board.update();
    }, horizontal_rectangle);

JXG.addEvent(cb_vertical_axis.rendNodeCheckbox, 'change', 
	function() {
		cb_horizontal_axis.rendNodeCheckbox.checked = false;	
		cb_vertical_axis.rendNodeCheckbox.checked = true;
		horizontal_axis.setAttribute({ visible: false });
		horiz_axis_loc.setAttribute({ visible: false });
		vertical_axis.setAttribute({ visible: true });
		vert_axis_loc.setAttribute({ visible: true });
		set_method();
		board.update();
    }, cb_vertical_axis);
		
JXG.addEvent(cb_horizontal_axis.rendNodeCheckbox, 'change', 
	function() {
    	cb_horizontal_axis.rendNodeCheckbox.checked = true;	
		cb_vertical_axis.rendNodeCheckbox.checked = false;
		horizontal_axis.setAttribute({ visible: true });
		horiz_axis_loc.setAttribute({ visible: true });
		vertical_axis.setAttribute({ visible: false });
		vert_axis_loc.setAttribute({ visible: false });
		set_method();
		board.update();
    }, cb_horizontal_axis);	
	
var width = 0.25;

// horizontal rectangle: P1 = ( g1(y - w/2), y - w/2  )
// vertical rectangle: P1 = ( x - w/2, f1(x - w/2) )

var P1 = board.create('point', [
			function() {
				if(horizontal_rectangle.Value()) {
					left_f = document.getElementById('left_bound').value;
					if(left_f != '') {
						return evaluate(left_f, slider.Value() - (width / 2), 'y');
					} else return 0;
				} else if(vertical_rectangle.Value()) {
					return slider.Value() - (width / 2);
				} else return 0;
			}, 
			function() { 
				if(horizontal_rectangle.Value()) {
					return slider.Value() - (width / 2); 
				} else if (vertical_rectangle.Value()) {
					lower_f = document.getElementById('lower_bound').value;
					if(lower_f != '') {
						return evaluate(lower_f, slider.Value() + (width / 2), 'x');
					} else return 0;
				} else return 0;
			}], 
			{ visible: false, name: 'P1' });
			
// horizontal rectangle: P2 = (g2(y - w/2), g1(y - w/2) )
// vertical rectangle: P2 = (x - w/2, f2(x - w/2))		
	
var P2 = board.create('point', [
			function() { 
				if(horizontal_rectangle.Value()) {
					right_f = document.getElementById('right_bound').value;
					if(right_f != '') {
						return evaluate(right_f, slider.Value() - (width / 2), 'y'); 
					} else return 0;
				} else if(vertical_rectangle.Value()) {
					return slider.Value() - (width / 2);
				} else return 0;
			}, 
			function() { 
				if(horizontal_rectangle.Value()) {
					return slider.Value() - (width / 2); 
				} else if(vertical_rectangle.Value()) {
					upper_f = document.getElementById('upper_bound').value;
					if(upper_f != '') {
						return evaluate(upper_f, slider.Value() + (width / 2), 'x');
					} else return 0;
				} else return 0;
			}], 
			{ visible: false, name: 'P2' });
			
// horizontal rectangle: P3 = (g2(y - w/2), g1(y - w/2) + w )
// vertical rectangle: P3 = (x + width, f2(x + width))
			
var P3 = board.create('point', [
	function() { 
		if(horizontal_rectangle.Value()) {
			right_f = document.getElementById('right_bound').value;
			if(right_f != '') {
				return evaluate(right_f, slider.Value() - (width / 2), 'y'); 
			} else return 0;
		} else if(vertical_rectangle.Value()) {
			return slider.Value() + width; 
		} else return 0;
	}, 
	function() { 
		if(horizontal_rectangle.Value()) {
			return P1.Y() + width; 
		} else if(vertical_rectangle.Value()) {
			upper_f = document.getElementById('upper_bound').value;
			if(upper_f != '') {
				return evaluate(upper_f, slider.Value() + (width / 2), 'x');
			} else return 0;
		} else return 0;
	}], 
	{ visible: false, name: 'P3' });
			
// horizontal rectangle: P4 = ( g1(y - w/2), g1(y - w/2) + w )
// vertical rectangle: P4 = (x + width, f1(x + width))			
			
var P4 = board.create('point', [
	function() { 
		if(horizontal_rectangle.Value()) {
			return P1.X(); 
		} else if(vertical_rectangle.Value()) {
			return slider.Value() + width;
		} else return 0;
	}, 
	function() { 
		if(horizontal_rectangle.Value()) {
			return P1.Y() + width; 
		} else if(vertical_rectangle.Value()) {
			lower_f = document.getElementById('lower_bound').value;
			if(lower_f != '') {
				return evaluate(lower_f, slider.Value() + (width / 2), 'x');
			} else return 0;
		} else return 0;
	}],
	{ visible: false, name: 'P4' });
	
rectangle = board.create('polygon', [P1, P2, P3, P4]);

function evaluate(f, x, v) {
	strf = f.slice(2);
	strf = changeVariable(strf, v, 't');
	relation = board.jc.snippet(strf, true, 't', true);
	return relation(x);
}

function update() {

	var upper_f = document.getElementById('upper_bound').value;
	curves[0] = plot_relation(curves[0], upper_f);
	
	var lower_f = document.getElementById('lower_bound').value;
	curves[1] = plot_relation(curves[1], lower_f);
	
	var right_f = document.getElementById('right_bound').value;
	curves[2] = plot_relation(curves[2], right_f);
	
	var left_f = document.getElementById('left_bound').value;
	curves[3] = plot_relation(curves[3], left_f);	
		
	slider_min = parseInt(document.getElementById('slider_min').value);
	slider_max = parseInt(document.getElementById('slider_max').value);
	slider_avg = (slider_min + slider_max) / 2;
	slider.setMin(slider_max);	
	slider.setMax(slider_min);
	slider.setValue(slider_avg);
	slider.update();
	
	board.update();	
		
}

function plot_relation(curve, ogtxt) {
	if(ogtxt.indexOf('=') != -1) {
		if(ogtxt.charAt(0) == 'y') {
		    // This is a function of the form y = f(x)
			strf = ogtxt.slice(2);
			strf = changeVariable(strf, 'x', 't');
			relation = board.jc.snippet(strf, true, 't', true);
			curve.X = function(t) { return t; };
			curve.Y = relation;
			curve.setAttribute( { visible: true } );
			curve.updateCurve();
		}
		if(ogtxt.charAt(0) == 'x') {
			// This is a function of the form x = g(y)
			strf = ogtxt.slice(2);
			strf = changeVariable(strf, 'y', 't');
			relation = board.jc.snippet(strf, true, 't', true);
			curve.X = relation;
			curve.Y = function(t) { return t; };
			curve.setAttribute( { visible: true } );
			curve.updateCurve();
		}
	} else if(ogtxt == '') {
		curve.X == function(t) { return 0; };
		curve.Y == function(t) { return 0; };
		curve.setAttribute( { visible: false } );
		curve.updateCurve();
	}
	return curve;
}

function changeVariable(s, a, b) {

	s = replaceAll(s, a, b);
	s = replaceAll(s, 'etp', 'exp');

	return s;
}

function replaceAll(s, a, b) {

	while(s.indexOf(a) != -1) {
		s = s.replace(a, b);
	}
	return s;

}

</script>
</body>
</html>