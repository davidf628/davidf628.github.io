<!doctype html>
<meta charset="utf-8">

<html lang="en">
<head>
	<title>Intersection of Three Planes</title>
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
</head>
<body>

<!-----------------------------------------------------------------------------
-- This program shows the solution to the 3x3 system of equations:
--
--   x -  y +  z =  -1
--  4x +  y - 2z =   5
-- -3x - 3y - 4z = -16
--
-- which is located at the point (1,3,1)
--
------------------------------------------------------------------------------>

<script src="js/three.min.js"></script>
<script src="js/SceneUtils.js"></script>
<script src="js/stats.js"></script>
<script src="js/OrbitControls.js"></script>
<script src="js/DragControls.js"></script>
<script src="js/parser.js"></script>
<script src="js/THREEx.KeyboardState.js"></script>
<script src="js/THREEx.FullScreen.js"></script>
<script src="js/THREEx.WindowResize.js"></script>
<script src="js/3dmath.js"></script>

<!-- Library for the menuing system -->
<script type='text/javascript' src='js/dat.gui.min.js'></script>

<!-- Libraries for MathJax to display math formulas on screen -->
<script type="text/x-mathjax-config">
      MathJax.Hub.Config({
      tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
      });
    </script>
    <script type="text/javascript" src="./MathJax-2.2-latest/MathJax.js?config=TeX-AMS-MML_SVG"></script>

<!-- jQuery code to display an information button and box when clicked. -->
<script src="js/jquery-1.9.1.js"></script>
<script src="js/jquery-ui.js"></script>
<link rel=stylesheet href="css/jquery-ui.css" />
<link rel=stylesheet href="css/info.css"/>
<script src="js/info.js"></script>
<div id="infoButton"></div>
<div id="infoBox" title="Intersection of Three Planes">
	This program shows the solution in 3D of the 3x3 system of equations:</br></br>
	<p align='center'>Plane 1: $x-y+z=-1$</p>
	<p align='center'>Plane 2: $4x+y-2z=5$</p>
	<p align='center'>Plane 3: $-3x-3y-4z=-16$</p>
	</br>
	Which is the point in space located at: $$(1, 3, 1)$$
	You can rotate by swiping with your finger or dragging with the mouse. You can zoom by pinching the screen or using the mousewheel.
	Pressing 'm' will make the window toggle fullscreen mode.</br></br>
	Note that the x-axis is green, the y-axis is red and the z-axis is blue.
</div>


<div id="ThreeJS" style="position: absolute; left:0px; top:0px"></div>
<script>

var container, scene, camera, renderer, controls, stats;
var keyboard = new THREEx.KeyboardState();
var clock = new THREE.Clock();

var plane1, plane2, plane3, intersection;

var parameters = {

	toggleplane1: function() { plane1.toggleVisible(); },
	toggleplane2: function() { plane2.toggleVisible(); },
	toggleplane3: function() { plane3.toggleVisible(); },
	toggleintersection: function() { intersection.toggleVisible(); }
	
};

// initialization
init();

// animation loop / game loop
animate();
					
function init() {

	// SCENE 	
	scene = new THREE.Scene();

	// CAMERA 	
	var SCREEN_WIDTH = window.innerWidth, SCREEN_HEIGHT = window.innerHeight;	
	var VIEW_ANGLE = 45, ASPECT = SCREEN_WIDTH / SCREEN_HEIGHT, NEAR = 0.1, FAR = 20000;
	camera = new THREE.PerspectiveCamera( VIEW_ANGLE, ASPECT, NEAR, FAR);
	scene.add(camera);
	camera.position.set(40,40,10);
	camera.up.set(0, 0, 1);  // make sure z-axis is facing up
	camera.lookAt(scene.position);	
	
	// RENDERER 	
	renderer = new THREE.WebGLRenderer( {antialias:true, alpha: true} );	
	renderer.setClearColor( 0xffffff);
	renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);
	renderer.sortObjects = false;
	renderer.localClippingEnabled = true;
	
	// attach div element to variable to contain the renderer
	container = document.getElementById( 'ThreeJS' );
	container.appendChild( renderer.domElement );
	
	// EVENTS 	
	THREEx.WindowResize(renderer, camera);
	THREEx.FullScreen.bindKey({ charCode : 'm'.charCodeAt(0) });
	
	// CONTROLS 
	controls = new THREE.OrbitControls( camera, renderer.domElement );
	
	
	// STATS 	
	stats = new Stats();
	stats.domElement.style.position = 'absolute';
	stats.domElement.style.bottom = '0px';
	stats.domElement.style.zIndex = 100;
	container.appendChild( stats.domElement );
		
	// GUI CONTROLLER
	var gui = new dat.GUI();
	gui.add(parameters, 'toggleplane1').name('Toggle Plane 1');
	gui.add(parameters, 'toggleplane2').name('Toggle Plane 2');
	gui.add(parameters, 'toggleplane3').name('Toggle Plane 3');
	gui.add(parameters, 'toggleintersection').name('Toggle Intersection');	
	
	createScene();
}

function createScene() {

	while(scene.children.length > 0){ 
		scene.remove(scene.children[0]); 
	}

	var light = new THREE.AmbientLight( 0xffffff );
	scene.add( light );
	
	var axes = createAxes({ labels: false });
	plane1 = new Surface('-x+y-1', { color: new THREE.Color('green'), visible: false });
	plane2 = new Surface('(y + 4*x - 5)/2', { color: new THREE.Color('red'), visible: false });
	plane3 = new Surface('(16-3*x-3*y)/4', { color: new THREE.Color('blue'), visible: false });
	intersection = new Point( { coords: [1, 3, 1], visible: false } );
	
	scene.add(axes);
	
	scene.add(plane1.getObject());
	scene.add(plane2.getObject());
	scene.add(plane3.getObject());
	scene.add(intersection.getObject());

}

function animate() {
    requestAnimationFrame( animate );
	render();		
	update();
}

function update()
{
	// delta = change in time since last call (in seconds)
	var delta = clock.getDelta(); 
		
	controls.update();
	stats.update();
}

function render() {	
	renderer.render( scene, camera );
}

</script>

</body>
</html>
